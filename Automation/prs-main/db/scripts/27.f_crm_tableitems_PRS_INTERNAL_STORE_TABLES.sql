--PRS_INTERNAL_STORE
CREATE TABLE PRSDBM.PRS_INTERNAL_STORE (
    INTL_STORE_N       VARCHAR2(11) NOT NULL,
    SUPP_C             VARCHAR2(30) NOT NULL,
    WBS_AC_N           VARCHAR2(50) NOT NULL,
    GL_AC_N            VARCHAR2(20) NOT NULL,
    CHM_LOC_N          VARCHAR2(50) NOT NULL,
    FAC_C              VARCHAR2(2) NOT NULL,
    DEPT_C             VARCHAR2(3) NOT NULL,
    DEFUNCT_F          VARCHAR2(1) NOT NULL,
    REC_CREATEUSER_I   VARCHAR2(12),
    REC_CREATE_DTM     DATE,
    REC_UPDUSER_I      VARCHAR2(12),
    REC_UPD_DTM        DATE
)
TABLESPACE S1_DAT
;

COMMENT ON TABLE PRSDBM.PRS_INTERNAL_STORE IS 'THIS TABLE STORES THE DETAILS OF THE INTERNAL STORES SUCH AS NUS CHEMSTORE (FOS) AND NUMI (SOM).'
;

COMMENT ON COLUMN PRSDBM.PRS_INTERNAL_STORE.INTL_STORE_N IS 'SEQUENCE NUMBER TO IDENTIFIY AN INTERNAL STORE.';

COMMENT ON COLUMN PRSDBM.PRS_INTERNAL_STORE.SUPP_C IS 'CODE TO REFER TO SUPPLIER.';

COMMENT ON COLUMN PRSDBM.PRS_INTERNAL_STORE.WBS_AC_N IS 'WBS ACCOUNT NUMBER FOR THIS INTERNAL STORE FOR CREADIT WHEN PEOPLE BUY ITEMS FROM IT. THIS WBS ACCOUNT IS NOT KEPT IN PRS_WBS WHICH STORES WBS ACCOUNTS RETRIEVED FROM BACKEND FOR USE BY REQUSTOR TO RAISE PURCHASE REQUEST.'
;

COMMENT ON COLUMN PRSDBM.PRS_INTERNAL_STORE.GL_AC_N IS 'GL ACCOUNT FOR THE INTERNAL STORE.';

COMMENT ON COLUMN PRSDBM.PRS_INTERNAL_STORE.CHM_LOC_N IS 'LOCATION ID FROM LMMS.';

COMMENT ON COLUMN PRSDBM.PRS_INTERNAL_STORE.FAC_C IS 'THE FACULTY THE INTERNAL STORE BELONGS TO.';

COMMENT ON COLUMN PRSDBM.PRS_INTERNAL_STORE.DEPT_C IS 'THE DEPARTMENT  THE INTERNAL STORE BELONGS TO.';

COMMENT ON COLUMN PRSDBM.PRS_INTERNAL_STORE.DEFUNCT_F IS 'FLAG TO DENOTE IF THIS GL ACCOUNT HAS BEEN DEFUNCT.';

COMMENT ON COLUMN PRSDBM.PRS_INTERNAL_STORE.REC_CREATEUSER_I IS 'RECORD CREATED USER ID. NO FK AS USER CAN COME FROM BOTH STAFF AND STUDENT SIDES.'
;

COMMENT ON COLUMN PRSDBM.PRS_INTERNAL_STORE.REC_CREATE_DTM IS 'RECORD CREATED DATE.';

COMMENT ON COLUMN PRSDBM.PRS_INTERNAL_STORE.REC_UPDUSER_I IS 'RECORD UPDATED BY USER ID. NO FK AS USER CAN COME FROM BOTH STAFF AND STUDENT SIDES.'
;

COMMENT ON COLUMN PRSDBM.PRS_INTERNAL_STORE.REC_UPD_DTM IS 'RECORD UPDATED BY DATE.';

ALTER TABLE PRSDBM.PRS_INTERNAL_STORE ADD CONSTRAINT PRS_PIS_PK_IS PRIMARY KEY ( INTL_STORE_N );

ALTER TABLE PRSDBM.PRS_INTERNAL_STORE ADD CONSTRAINT PRS_PIS_FK_DC FOREIGN KEY ( DEPT_C )
    REFERENCES DEPARTMENT ( DEPT_C );

ALTER TABLE PRSDBM.PRS_INTERNAL_STORE ADD CONSTRAINT PRS_PIS_FK_FC FOREIGN KEY ( FAC_C )
    REFERENCES FACULTY ( FAC_C );

ALTER TABLE PRSDBM.PRS_INTERNAL_STORE ADD CONSTRAINT PRS_PIS_FK_SC FOREIGN KEY ( SUPP_C )
    REFERENCES PRSSUPPLIER ( SUPP_C );

ALTER TABLE PRSDBM.PRS_INTERNAL_STORE ADD CONSTRAINT PRS_PIS_CK_DF CHECK (DEFUNCT_F IN ('Y', 'N'));

--PRS_USER_ACCESSTP
DROP TABLE PRSDBM.PRS_USER_ACCESSTP CASCADE CONSTRAINTS;
CREATE TABLE PRSDBM.PRS_USER_ACCESSTP (
    ACCESSTP_N   VARCHAR2(11) NOT NULL,
    ACCESS_N     VARCHAR2(11) NOT NULL,
    ACCESSTP_C   VARCHAR2(50) NOT NULL,
    ACCESSTP_T   VARCHAR2(50) NOT NULL,
    DEFUNCT_F    VARCHAR2(1)
)
TABLESPACE S1_DAT
;

COMMENT ON TABLE PRSDBM.PRS_USER_ACCESSTP IS 'TABLE STORES ADDITIONAL USER ACCESS ATTRIBUTES THAT ARE APPLIED TO THE USER ACCESS RECORD. FOR EXAMPLE,WHICH INTERNAL STORE A LABORATORY SUPPLY OFFICER HANDLES,ETC.'
;

COMMENT ON COLUMN PRSDBM.PRS_USER_ACCESSTP.ACCESSTP_N IS 'ID OF USER ATTRIBUTE RECORD. GENERATED BY ORACLE SEQUENCE.';

COMMENT ON COLUMN PRSDBM.PRS_USER_ACCESSTP.ACCESS_N IS 'REFERENCE TO THE USER ACCESS RECORD THIS ATTRIBUTE APPLIES TO.';

COMMENT ON COLUMN PRSDBM.PRS_USER_ACCESSTP.ACCESSTP_C IS 'CODE OF ATTRIBUTE TO BE APPLIED TO THE USER ACCESS RECORD. E.G. STORE_TYPE_INTERNAL,ETC.'
;

COMMENT ON COLUMN PRSDBM.PRS_USER_ACCESSTP.ACCESSTP_T IS 'STORE THE VALUE OR REFERENCE VALUE OF THE NAME INDICATED.';

COMMENT ON COLUMN PRSDBM.PRS_USER_ACCESSTP.DEFUNCT_F IS 'TO INDICATE IF THE ATTRIBUTE IS ACTIVE OR NOT.';

ALTER TABLE PRSDBM.PRS_USER_ACCESSTP ADD CONSTRAINT PRS_PUA_PK_AT PRIMARY KEY ( ACCESSTP_N );

ALTER TABLE PRSDBM.PRS_USER_ACCESSTP ADD CONSTRAINT PRS_PUA_FK_AC FOREIGN KEY ( ACCESSTP_C )
    REFERENCES PRSCTABLE ( CODE_C );

ALTER TABLE PRSDBM.PRS_USER_ACCESSTP ADD CONSTRAINT PRS_PUA_FK_AN FOREIGN KEY ( ACCESS_N )
    REFERENCES PRS_USER_ACCESS ( ACCESS_N );
	
ALTER TABLE PRSDBM.PRS_USER_ACCESSTP ADD CONSTRAINT PRS_PUA_CK_DF CHECK (DEFUNCT_F IN ('Y', 'N'));

--PRS_COLLECTION
CREATE TABLE PRSDBM.PRS_COLLECTION (
    COLLECT_N        VARCHAR2(11) NOT NULL,
    COLLECT_STS_C    VARCHAR2(50) NOT NULL,
    PR_N             VARCHAR2(11) NOT NULL,
    REC_CREATE_DTM   DATE,
    REC_UPD_DTM      DATE
)
TABLESPACE S1_DAT
;

COMMENT ON TABLE PRSDBM.PRS_COLLECTION IS 'THIS TABLE STORES THE DETAILS OF THE COLLECTIONS WHICH ARE HANDLED BY THE LABORATORY SUPPLY ADMINISTRATOR FOR THE INTERNAL STORES.'
;

COMMENT ON COLUMN PRSDBM.PRS_COLLECTION.COLLECT_N IS 'SEQUENCE NUMBER TO IDENTIFY A COLLECTION.';

COMMENT ON COLUMN PRSDBM.PRS_COLLECTION.COLLECT_STS_C IS 'COLLECTION STATUS.
1. Pending verification
2. Pending collection
3. Collected (for collection)
4. Rejected (for verification)
5. Cancelled (for collection)
'
;

COMMENT ON COLUMN PRSDBM.PRS_COLLECTION.PR_N IS 'REFER TO PURCHASE REQUEST.';

COMMENT ON COLUMN PRSDBM.PRS_COLLECTION.REC_CREATE_DTM IS 'RECORD CREATED DATE.';

COMMENT ON COLUMN PRSDBM.PRS_COLLECTION.REC_UPD_DTM IS 'RECORD UPDATED DATE.';

ALTER TABLE PRSDBM.PRS_COLLECTION ADD CONSTRAINT PRS_PCN_PK_CN PRIMARY KEY ( COLLECT_N );

ALTER TABLE PRSDBM.PRS_COLLECTION ADD CONSTRAINT PRS_PCN_FK_CS FOREIGN KEY ( COLLECT_STS_C )
    REFERENCES PRSCTABLE ( CODE_C );

ALTER TABLE PRSDBM.PRS_COLLECTION ADD CONSTRAINT PRS_PCN_FK_PN FOREIGN KEY ( PR_N )
    REFERENCES PRS_PURCHASE_REQ ( PR_N );
	
--PRS_COLLECTION_REMARK
CREATE TABLE PRSDBM.PRS_COLLECTION_REMARK (
    COLLECT_REMK_N     VARCHAR2(11) NOT NULL,
    COLLECT_REMK_T     CLOB NOT NULL,
    REC_CREATEUSER_I   VARCHAR2(12) NOT NULL,
    REC_CREATE_DTM     DATE NOT NULL,
    COLLECT_N          VARCHAR2(11) NOT NULL,
    COLLECT_STS_C      VARCHAR2(50) NOT NULL
)
TABLESPACE S1_DAT
;

COMMENT ON TABLE PRSDBM.PRS_COLLECTION_REMARK IS 'THIS TABLE STORES REMARKS FOR ACTIONS ON THE COLLECTIONS,SUCH AS COLLECTION INSTRUCTIONS AND REASONS OF STATUS CHANGE.'
;

COMMENT ON COLUMN PRSDBM.PRS_COLLECTION_REMARK.COLLECT_REMK_N IS 'SEQUENCE NUMBER TO INDICATE ONE COLLECTION REMARK.';

COMMENT ON COLUMN PRSDBM.PRS_COLLECTION_REMARK.COLLECT_REMK_T IS 'REMARKS RELATED TO THE COLLECITON STATUS IN THIS RECORD.';

COMMENT ON COLUMN PRSDBM.PRS_COLLECTION_REMARK.REC_CREATEUSER_I IS 'TO KEEP THE USER WHO HAS CREATED THIS REMARK. NO FK AS USER CAN COME FROM BOTH STAFF AND STUDENT SIDES.';

COMMENT ON COLUMN PRSDBM.PRS_COLLECTION_REMARK.REC_CREATE_DTM IS 'TIME WHEN THE REMARK RECORD IS CREATED.';

COMMENT ON COLUMN PRSDBM.PRS_COLLECTION_REMARK.COLLECT_N IS 'THE COLLECTION RECORD THIS REMARK IS RELATED TO.';

COMMENT ON COLUMN PRSDBM.PRS_COLLECTION_REMARK.COLLECT_STS_C IS 'THE STATUS OF THE COLLECTION WHEN THE REMARK IS CREATED.';

ALTER TABLE PRSDBM.PRS_COLLECTION_REMARK ADD CONSTRAINT PRS_PCR_PK_CR PRIMARY KEY ( COLLECT_REMK_N );

ALTER TABLE PRSDBM.PRS_COLLECTION_REMARK ADD CONSTRAINT PRS_PCR_FK_CN FOREIGN KEY ( COLLECT_N )
    REFERENCES PRS_COLLECTION ( COLLECT_N );

ALTER TABLE PRSDBM.PRS_COLLECTION_REMARK ADD CONSTRAINT PRS_PCR_FK_CS FOREIGN KEY ( COLLECT_STS_C )
    REFERENCES PRSCTABLE ( CODE_C );

	
/* ----------------------------------------------------------------------
SEQUENCE: PRSDBM.PRS_INTERNAL_STORE_SEQ
---------------------------------------------------------------------- */
CREATE SEQUENCE PRSDBM.PRS_INTERNAL_STORE_SEQ
    START WITH 1
    MINVALUE 1
    INCREMENT BY 1
    NOCYCLE
    NOCACHE;

GRANT SELECT ON PRSDBM.PRS_INTERNAL_STORE_SEQ TO PRJPRS;

/* ----------------------------------------------------------------------
SEQUENCE: PRS_USER_ACCESSATTR_SEQ
---------------------------------------------------------------------- */
CREATE SEQUENCE PRSDBM.PRS_USER_ACCESSTP_SEQ
    START WITH 1
    MINVALUE 1
    INCREMENT BY 1
    NOCYCLE
    NOCACHE;

GRANT SELECT ON PRSDBM.PRS_USER_ACCESSTP_SEQ TO PRJPRS;


/* ----------------------------------------------------------------------
SEQUENCE: PRS_PRS_COLLECTION_SEQ
---------------------------------------------------------------------- */
CREATE SEQUENCE PRSDBM.PRS_COLLECTION_SEQ
    START WITH 1
    MINVALUE 1
    INCREMENT BY 1
    NOCYCLE
    NOCACHE;

GRANT SELECT ON PRSDBM.PRS_COLLECTION_SEQ TO PRJPRS;


/* ----------------------------------------------------------------------
SEQUENCE: PRS_COLLECTION_REMARK_SEQ
---------------------------------------------------------------------- */
CREATE SEQUENCE PRSDBM.PRS_COLLECTION_REMARK_SEQ
    START WITH 1
    MINVALUE 1
    INCREMENT BY 1
    NOCYCLE
    NOCACHE;

GRANT SELECT ON PRSDBM.PRS_COLLECTION_REMARK_SEQ TO PRJPRS;

/* ----------------------------------------------------------------------
GRANT: Who and what privilege to grant
---------------------------------------------------------------------- */
GRANT DELETE, INSERT, SELECT, UPDATE ON PRSDBM.PRS_INTERNAL_STORE TO PRJPRS;
GRANT SELECT ON PRSDBM.PRS_INTERNAL_STORE TO RPTPRS;

GRANT DELETE, INSERT, SELECT, UPDATE ON PRSDBM.PRS_USER_ACCESSTP TO PRJPRS;
GRANT SELECT ON PRSDBM.PRS_USER_ACCESSTP TO RPTPRS;

GRANT DELETE, INSERT, SELECT, UPDATE ON PRSDBM.PRS_COLLECTION TO PRJPRS;
GRANT SELECT ON PRSDBM.PRS_COLLECTION TO RPTPRS;

GRANT DELETE, INSERT, SELECT, UPDATE ON PRSDBM.PRS_COLLECTION_REMARK TO PRJPRS;
GRANT SELECT ON PRSDBM.PRS_COLLECTION_REMARK TO RPTPRS;


